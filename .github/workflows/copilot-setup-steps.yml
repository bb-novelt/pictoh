name: "Copilot Setup Steps"

# This workflow is automatically executed by GitHub Copilot agents
# before they start working on the repository. It sets up the development
# environment to save time and ensure consistency.
#
# IMPORTANT: The job MUST be named "copilot-setup-steps" for Copilot to recognize it.
# IMPORTANT: This file MUST be named "copilot-setup-steps.yml" and be in .github/workflows/

on:
  workflow_dispatch:
  push:
    paths:
      - .github/workflows/copilot-setup-steps.yml
  pull_request:
    paths:
      - .github/workflows/copilot-setup-steps.yml

jobs:
  copilot-setup-steps:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Verify Nx installation
        run: npx nx --version
      
      - name: Build the application
        run: npx nx build pictho-app
      
      - name: Run tests
        run: npx nx test pictho-app || echo "Tests not yet configured"
      
      - name: Display setup completion
        run: |
          echo "âœ… GitHub Copilot agent environment setup completed successfully!"
          echo "ðŸ“¦ Node.js version: $(node --version)"
          echo "ðŸ“¦ npm version: $(npm --version)"
          echo "ðŸ“¦ Nx version: $(npx nx --version)"
          echo ""
          echo "The environment is ready for Copilot agents to work on the Pict'Oh project."
