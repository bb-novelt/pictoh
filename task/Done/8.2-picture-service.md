# Task 8.2: Picture Service

**Epic**: Epic 8: Picture Management & Selection

## Task Details

- [x] Create `PictureService` class
- [x] Implement `getAllPictures()` - returns built-in + user-added (all loaded on first access)
- [x] Implement `getBuiltInPictures()` - from `/assets/pictures/*`
- [x] Implement `getUserAddedPictures()` - user uploaded pictures
- [x] Implement `searchPictures(query: string)` - filter by name/text
- [x] Implement `getPicturesSortedByLastUsed()` - for 50-picture limit management
- [x] Implement `updateLastUsedTime(pictureId)` - track picture usage
- [x] Implement alphabetical sorting
- [x] Cache loaded pictures in memory
- [x] **Note**: Library will eventually contain thousands of images

## File Location

Place all files for this task inside `src/pictures/` (feature folder for picture management).
Example: `src/pictures/pictureService.ts`

## Completion Summary

**Date Completed**: 2026-02-24

**Work Done**:

- Created `src/pictures/pictureService.ts` with a `PictureService` class exposing:
  - `getBuiltInPictures()` – returns all built-in pictures alphabetically, cached in memory (shallow copies so mutations stay local to the service).
  - `getUserAddedPictures()` – returns in-memory user-added pictures alphabetically.
  - `addUserPicture(id, text, src)` – registers a new user-added picture.
  - `getAllPictures()` – combines built-in + user-added, sorted alphabetically.
  - `searchPictures(query)` – case-insensitive filter across all pictures.
  - `updateLastUsedTime(pictureId)` – stamps the picture with the current timestamp.
  - `getPicturesSortedByLastUsed()` – sorts all pictures by recency (most recent first, untouched pictures last).
  - `createBuiltIn(stem)` – convenience wrapper around `createBuiltInPicture`.
  - `reset()` – clears caches (used in tests).
- Exported `PICTURE_DISPLAY_LIMIT = 50` constant.
- Exported `pictureService` singleton for app-wide use.
- Added `src/pictures/pictureService.test.ts` with 23 tests covering all methods.

**Notes**:

- User-added pictures are held in memory only for this session; persistence will be added in Epic 9 (storage service).
- `getBuiltInPictures()` creates shallow copies of `BUILT_IN_PICTURES` objects so calling `updateLastUsedTime` never mutates the shared module-level array.
