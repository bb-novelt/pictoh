# Task 8.3: Picture Selection UI

**Epic**: Epic 8: Picture Management & Selection

## Task Details

- [x] Create `PictureSelector` component
- [x] Show **search/filter text input** for finding pictures
- [x] Add **filter toggle**: Built-in pictures, User-added pictures, or Both
- [x] Display filtered pictures in grid
- [x] Display maximum **50 pictures** at once
- [x] New pictures replace the **last used** picture (based on `lastUsedTime`)
- [x] Implement pagination or virtual scrolling for performance
- [x] Show picture name below each thumbnail
- [x] Highlight currently selected picture
- [x] Handle picture click/selection
- [x] **Do not show favorite count**
- [x] Support user adding new pictures (upload functionality)

## File Location

Place all files for this task inside `src/pictures/` (feature folder for picture management).
Example: `src/pictures/PictureSelector.tsx`

## Completion Summary

**Date Completed**: 2026-02-24

**Work Done**:

- Created `src/pictures/PictureSelector.tsx` — full picture browser component with:
  - Search input (Rechercher une image…)
  - Filter toggle: Toutes / Bibliothèque / Mes images
  - Scrollable grid (max 50 pictures, most recently used prioritised when over limit)
  - Picture name displayed below each thumbnail
  - Currently selected picture highlighted with blue border
  - Upload button (Ajouter) for user-added pictures
  - Broken-image fallback (shows "?" on load error)
- Created `src/pictures/pictureUtils.ts` — pure `getDisplayPictures()` logic (filter + search + 50-limit, alphabetically sorted output)
- Created `src/pictures/pictureUtils.test.ts` — 12 unit tests covering filter, search, and display-limit logic
- Updated `src/editMode/SquareEditModal.tsx` to use `<PictureSelector>` instead of the empty placeholder

**Notes**:

- `getDisplayPictures` was extracted to `pictureUtils.ts` to keep the component file export-clean (react-refresh lint rule)
- The `PictureSelector` uses a revision counter (setter only) to force re-reads from `pictureService` when `lastUsedTime` or user pictures change

**Screenshot**:

![PictureSelector in SquareEditModal](https://github.com/user-attachments/assets/d04bd93c-673e-4e18-8876-8a67fb8410fd)
