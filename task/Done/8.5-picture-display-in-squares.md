# Task 8.5: Picture Display in Squares

**Epic**: Epic 8: Picture Management & Selection

## Task Details

- [x] Optimize image loading and display
- [x] Use appropriate image sizes
- [x] All images **cached on first load** (no lazy loading)
- [x] **User-added images cached immediately** when added to a square
- [x] Cache loaded images in browser for offline use
- [x] Handle missing/broken images gracefully
- [x] Show text above picture when configured

## File Location

Image display logic belongs in `src/grid/` (the Square component feature folder).
Picture loading/caching utilities belong in `src/pictures/`.

## Completion Summary

**Date Completed**: 2026-02-24

**Work Done**:

- Updated `src/grid/Square.tsx` to handle broken images gracefully:
  - Added `errorSrc` state (tracks which `src` URL caused an error)
  - `imgError` is derived: `errorSrc === square.selectedPicture?.src`
  - When an image fails to load, a "?" placeholder is shown instead of the browser's broken-image icon
  - When the picture changes (new `src`), `imgError` automatically becomes false â€” no `useEffect` needed
- Text above/below picture was already implemented; no changes needed
- All images are cached via service worker on first launch (implemented in Epic 3)
- User-added images are cached immediately via `cacheUserPicture()` in `PictureSelector`
